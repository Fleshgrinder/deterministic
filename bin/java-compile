#!/usr/bin/env bash
set -Eeuo pipefail

format=${1:?missing required <format> argument}
version=${2:?missing required <version> argument}
dir="build/$format/$version"

printf '\e[1m> Compiled \e[37m%s %s java\e[0m\n' "$format" "$version" >&2
shopt -s globstar
printf '\e[31m' >&2
./build/jdk/bin/javac \
  -XDignore.symbol.file \
  -classpath "$dir/$format.jar" \
  -sourcepath "$dir"/code/java \
  -sourcepath src/java \
  -encoding utf-8 \
  -Werror \
  -d "$dir"/target/java \
  "$dir"/code/java/**/*.java \
  "src/java/${format^}Main.java" >&2
printf '\e[0m' >&2
